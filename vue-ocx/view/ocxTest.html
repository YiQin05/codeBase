<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="VI60_defaultClientScript" content="VBScript">
  <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
  <meta name="ProgId" content="FrontPage.Editor.Document">
  <title>动态插入测试</title>
  <script src="./vue.js"></script>
</head>
<body>
<h2>进入测试html</h2>
  <div id="app" style="height: 800px;">
    <!-- <object
      name="XDView1"
      ID="XDView1"
      width="640"
      height="480"
      CLASSID="CLSID:8DA9A0A7-AC21-4EA9-BB7E-43AEF89688A6"
      CODEBASE="/WebCMS.exe#Version=2,0,0,0">
    </object> -->
  </div>
<script>
var vm = new Vue({
  el: '#app',
  data: {
    url: '172.16.10.100',
    port: '5000',
    uname: 'admin',
    psw: 'admin',
    Channel: '0'
  },
  mounted: function () {
    console.log('增加AJS')
    var obj = document.getElementsByTagName('object')
    var flag = false
    for (var i = 0; i < obj.length; i++) {
      if (obj[i].getAttribute('id') === 'XDView1') {
        flag = true
        break
      }
    }
    console.log(4521653)
    console.log(document.getElementById('app'))
    if (!flag) {
      // var body = document.getElementsByTagName('body')[0]
      var body = document.getElementById('app')
      this.domAppend(body)
    }
    this.Login()
  },
  methods: {
    setAttr: function(attr, val) {
    var obj = document.createAttribute(attr)
    obj.value = val
    return obj
  },
  domAppend: function (body, id) {
    var obj = document.createElement('object')
    var objId = ''
    if (id) {
      objId = this.setAttr('id', id)
    } else {
      objId = this.setAttr('id', 'XDView1')
    }
    obj.setAttributeNode(objId)
    var objClassid = this.setAttr(
      'CLASSID',
      'CLSID:8DA9A0A7-AC21-4EA9-BB7E-43AEF89688A6'
    )
    obj.setAttributeNode(objClassid)
    var objName = this.setAttr('name', 'XDView1')
    obj.setAttributeNode(objName)
    var objWidth = this.setAttr('width', 640)
    obj.setAttributeNode(objWidth)
    var objHeight = this.setAttr('height', 480)
    obj.setAttributeNode(objHeight)
    body.appendChild(obj)
    console.log(15642121)
    console.log(body)
  },
  
  $: function(){
    var elements = new Array();
    for (var i = 0; i < arguments.length; i++) {
      var element = arguments[i];
      if (typeof element == 'string')
        element = document.getElementById(element);
      if (arguments.length == 1)
        return element;
      elements.push(element);
    }
    return elements;
  },
  Login: function() {
    console.log("见来了")
    this.$("XDView1").m_szUrl       = this.url		//'DVS地址
    this.$("XDView1").m_dwDataPort  = this.port		//'通讯端口
    this.$("XDView1").m_szUserName  = this.uname 	//用户名
    this.$("XDView1").m_szPassword  = this.psw		//密码
    this.$("XDView1").m_ProtocolType	= 0;
    this.$("XDView1").Login();
    this.$("XDView1").StartPreview();
  }
}
});

</script>
</body>
<!-- <style>
#XDView1 {
  height: 400px;
  width: 400px;
} 
</style> -->
</html>