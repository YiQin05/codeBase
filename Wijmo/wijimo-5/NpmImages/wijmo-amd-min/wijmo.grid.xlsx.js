/*
    *
    * Wijmo Library 5.20183.550
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)o.hasOwnProperty(l)&&(e[l]=o[l])};return function(o,l){function t(){this.constructor=o}e(o,l),o.prototype=null===l?Object.create(l):(t.prototype=l.prototype,new t)}}();define(["require","exports","wijmo/wijmo.grid","wijmo/wijmo.xlsx","wijmo/wijmo","wijmo/wijmo.grid.xlsx"],function(e,o,l,t,r,n){"use strict";function s(){var e,o;return(e=a.wijmo)&&(o=e.grid)&&o.detail}function i(){var e,o;return(e=a.wijmo)&&(o=e.grid)&&o.multirow}Object.defineProperty(o,"__esModule",{value:!0});var a="undefined"!=typeof window?window:self,d=n||o;a.wijmo=a.wijmo||{},a.wijmo.grid=a.wijmo.grid||{},a.wijmo.grid.xlsx=d;var u=function(){function e(){}return e.save=function(e,o,l){var t=this._saveFlexGridToWorkbook(e,o);return l&&t.save(l),t},e.saveAsync=function(e,o,l,t,r){var n=this._saveFlexGridToWorkbook(e,o);return l&&n.saveAsync(l,t,r),n},e.load=function(e,o,l){var n=this;if(o instanceof Blob){var s=new FileReader;s.onload=function(){var o=t.Workbook._base64EncArr(new Uint8Array(s.result)),r=new t.Workbook;r.load(o),o=null,e.deferUpdate(function(){n._loadToFlexGrid(e,r,l),r=null})},s.readAsArrayBuffer(o)}else if(o instanceof t.Workbook)e.deferUpdate(function(){n._loadToFlexGrid(e,o,l),o=null});else{if(o instanceof ArrayBuffer)o=t.Workbook._base64EncArr(new Uint8Array(o));else if(!r.isString(o))throw"Invalid workbook.";var i=new t.Workbook;i.load(o),o=null,e.deferUpdate(function(){n._loadToFlexGrid(e,i,l),i=null})}},e.loadAsync=function(e,o,l,n,s){var i=this;if(o instanceof Blob){var a=new FileReader;a.onload=function(){var o=t.Workbook._base64EncArr(new Uint8Array(a.result)),r=new t.Workbook;r.loadAsync(o,function(t){o=null,r=null,e.deferUpdate(function(){i._loadToFlexGrid(e,t,l),n&&n(t),t=null})},s)},a.readAsArrayBuffer(o)}else if(o instanceof t.Workbook)e.deferUpdate(function(){i._loadToFlexGrid(e,o,l),n&&n(o),o=null});else{if(o instanceof ArrayBuffer)o=t.Workbook._base64EncArr(new Uint8Array(o));else if(!r.isString(o))throw"Invalid workbook.";(new t.Workbook).loadAsync(o,function(t){o=null,e.deferUpdate(function(){i._loadToFlexGrid(e,t,l),n&&n(t),t=null})},s)}},e._saveFlexGridToWorkbook=function(e,o){var n,s,i,a,d,u,c,f,h,p,g,m,w,y=new t.Workbook,b=new t.WorkSheet,_=(new t.WorkbookStyle,new t.WorkbookFrozenPane),x=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,C=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,k=!o||null==o.includeCellStyles||o.includeCellStyles,v=o?o.activeWorksheet:null,S=o?o.includeColumns:null,T=o?o.formatItem:null,W=0,R=0,A=0,F=0,B=[];if(null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style),p=e.wj_sheetInfo,b.name=o?o.sheetName:"",b.visible=!o||!1!==o.sheetVisible,p&&p.tables&&p.tables.length>0)for(var H=0;H<p.tables.length;H++)b.tables.push(p.tables[H]);if(u=[],p||!k&&!T||((g=document.createElement("div")).style.visibility="hidden",g.setAttribute(l.FlexGrid._WJS_MEASURE,"true"),e.hostElement.appendChild(g)),C){for(f=0,c=0;c<e.rowHeaders.rows.length;c++)if(!(e.rowHeaders.rows[c].renderSize<=0)){for(u[f]=[],h=0;h<e.rowHeaders.columns.length;h++)i=e._getBindingColumn(e.rowHeaders,c,e.rowHeaders.columns[h]),a=this._getColumnSetting(i,h,e.columnHeaders.columns),u[f][h]=a,0===f&&((d=new t.WorkbookColumn)._deserialize(a),b._addWorkbookColumn(d,h));f++}F=h}if(e.columnHeaders.rows.length>0){for(f=0,c=0;c<e.columnHeaders.rows.length;c++)if(!(e.columnHeaders.rows[c].renderSize<=0)){for(u[f]||(u[f]=[]),h=0;h<e.columnHeaders.columns.length;h++)i=e._getBindingColumn(e.columnHeaders,c,e.columnHeaders.columns[h]),a=this._getColumnSetting(i,h,e.columnHeaders.columns),u[f][F+h]=a,0===f&&(S&&!S(i)||((d=new t.WorkbookColumn)._deserialize(a),b._addWorkbookColumn(d)));x&&(F=0,n={},s=new t.WorkbookRow,C&&(F=this._parseFlexGridRowToSheetRow(e.topLeftCells,n,c,0,u,k,g,B,!1,0,S,T)),this._parseFlexGridRowToSheetRow(e.columnHeaders,n,c,F,u,k,g,B,!1,0,S,T),n.cells.length>0&&(s._deserialize(n),b._addWorkbookRow(s,f))),f++}R=x?f:0}for(c=0;c<e.cells.rows.length;c++)F=0,n={},s=new t.WorkbookRow,(m=e.rows[c])instanceof l._NewRowTemplate||((w=m instanceof l.GroupRow)?W=r.tryCast(m,l.GroupRow).level:e.rows.maxGroupLevel>-1&&(W=e.rows.maxGroupLevel+1),C&&(F=this._parseFlexGridRowToSheetRow(e.rowHeaders,n,c,0,u,k,g,B,w,W,S,T)),this._parseFlexGridRowToSheetRow(e.cells,n,c,F,u,k,g,B,w,W,S,T),n.cells.length>0&&(s._deserialize(n),b._addWorkbookRow(s,R+c)));for(A=e.cells.rows.length,c=0;c<e.columnFooters.rows.length;c++)F=0,n={},s=new t.WorkbookRow,w=(m=e.columnFooters.rows[c])instanceof l.GroupRow,C&&(F=this._parseFlexGridRowToSheetRow(e.rowHeaders,n,c,0,u,k,g,B,w,0,S,T)),this._parseFlexGridRowToSheetRow(e.columnFooters,n,c,F,u,k,g,B,w,0,S,T),n.cells.length>0&&(s._deserialize(n),b._addWorkbookRow(s,R+A+c));return _.rows=x?e.frozenRows+R:e.frozenRows,_.columns=C?e.frozenColumns+F:e.frozenColumns,b.frozenPane=_,y._addWorkSheet(b),p||!k&&!T||(e.hostElement.removeChild(g),B.forEach(function(e){return e.forEach(function(e){e&&e.parentElement&&e.parentElement.removeChild(e)})})),y.activeWorksheet=v,y},e._loadToFlexGrid=function(e,o,n){var s,i,a,d,u,c,f,h,p,g,m,w,y,b,_,x,C,k,v,S,T,W,R,A,F,B,H,N,D,E,I,z,j=!n||null==n.includeColumnHeaders||n.includeColumnHeaders,G=!n||null==n.includeColumnHeaders||n.includeColumnHeaders,O=n&&null!=n.sheetIndex&&!isNaN(n.sheetIndex)?n.sheetIndex:0,L=n?n.sheetName:null,M=!n||n.sheetVisible,P=null!=e.wj_sheetInfo,V=0,U=0,X=!1,q={};if(e.itemsSource=null,e.columns.clear(),e.rows.clear(),e.frozenColumns=0,e.frozenRows=0,B={},H=[],U=0,a=[],N=[],O<0||O>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=L)for(s=0;s<o.sheets.length;s++)if(L===o.sheets[s].name){m=o.sheets[s];break}if(null!=(m=m||o.sheets[O]).rows){for(j&&(U=1,m.rows.length<=1&&(G=!1,U=0),f=m.rows[0]),y=this._getColumnCount(m.rows),w=this._getRowCount(m.rows,y),k=m.summaryBelow,i=m.columns,V=0;V<y;V++)e.columns.push(new l.Column),i[V]&&(isNaN(+i[V].width)||(e.columns[V].width=+i[V].width),i[V].visible||null==i[V].visible||(e.columns[V].visible=!!i[V].visible),i[V].style&&i[V].style.wordWrap&&(e.columns[V].wordWrap=i[V].style.wordWrap));for(;U<w;U++){if(b=!1,z=null,g=m.rows[U])for(x=U+1;x<m.rows.length;){if(C=m.rows[x]){(isNaN(g.groupLevel)&&!isNaN(C.groupLevel)||!isNaN(g.groupLevel)&&g.groupLevel<C.groupLevel)&&(b=!0);break}x++}for(b&&!k?(S&&(S.isCollapsed=X),(S=new l.GroupRow).isReadOnly=!1,X=null!=g.collapsed&&g.collapsed,S.level=isNaN(g.groupLevel)?0:g.groupLevel,q[S.level]=X,this._checkParentCollapsed(q,S.level)&&S._setFlag(l.RowColFlags.ParentCollapsed,!0),e.rows.push(S)):(v=new l.Row,g&&this._checkParentCollapsed(q,g.groupLevel)&&v._setFlag(l.RowColFlags.ParentCollapsed,!0),e.rows.push(v)),g&&g.height&&!isNaN(g.height)&&(e.rows[G?U-1:U].height=g.height),V=0;V<y;V++)if(g){if(_=g.cells[V],(R=_?_.formula:null)&&"="!==R[0]&&(R="="+R),_&&_.textRuns&&_.textRuns.length>0?(e.rows[G?U-1:U].isContentHtml=!0,e.setCellData(G?U-1:U,V,this._parseTextRunsToHTML(_.textRuns))):e.setCellData(G?U-1:U,V,R&&P?R:this._getItemValue(_)),b||this._setColumn(a,V,_),A=U*y+V,F=_?_.style:null,D=t.Workbook._parseExcelFormat(_),F){if(z=null==z?!!F.wordWrap:z&&!!F.wordWrap,E=this._getItemType(_),F.hAlign)I=t.Workbook._parseHAlignToString(r.asEnum(F.hAlign,t.HAlign));else switch(E){case r.DataType.Number:I="right";break;case r.DataType.Boolean:I="center";break;default:I=D&&0===D.search(/[n,c,p]/i)?"right":"left"}B[A]={fontWeight:F.font&&F.font.bold?"bold":"none",fontStyle:F.font&&F.font.italic?"italic":"none",textDecoration:F.font&&F.font.underline?"underline":"none",textAlign:I,fontFamily:F.font&&F.font.family?F.font.family:"",fontSize:F.font&&F.font.size?F.font.size+"px":"",color:F.font&&F.font.color?F.font.color:"",backgroundColor:F.fill&&F.fill.color?F.fill.color:"",whiteSpace:F.wordWrap?"pre-wrap":"normal",format:D},F.borders&&(F.borders.left&&(this._parseBorderStyle(F.borders.left.style,"Left",B[A]),B[A].borderLeftColor=F.borders.left.color),F.borders.right&&(this._parseBorderStyle(F.borders.right.style,"Right",B[A]),B[A].borderRightColor=F.borders.right.color),F.borders.top&&(this._parseBorderStyle(F.borders.top.style,"Top",B[A]),B[A].borderTopColor=F.borders.top.color),F.borders.bottom&&(this._parseBorderStyle(F.borders.bottom.style,"Bottom",B[A]),B[A].borderBottomColor=F.borders.bottom.color)),F.font&&-1===N.indexOf(F.font.family)&&N.push(F.font.family)}_&&r.isNumber(_.rowSpan)&&_.rowSpan>0&&r.isNumber(_.colSpan)&&_.colSpan>0&&(_.rowSpan>1||_.colSpan>1)&&H.push(new l.CellRange(U,V,U+_.rowSpan-1,V+_.colSpan-1))}g&&(this._checkParentCollapsed(q,g.groupLevel)||g.visible||null==g.visible||(e.rows[G?U-1:U].visible=g.visible),e.rows[G?U-1:U].wordWrap=!!g.style&&!!g.style.wordWrap||!!z)}for(S&&(S.isCollapsed=X),m.frozenPane&&(T=m.frozenPane.columns,r.isNumber(T)&&!isNaN(T)&&(e.frozenColumns=T),W=m.frozenPane.rows,r.isNumber(W)&&!isNaN(W)&&(e.frozenRows=G&&W>0?W-1:W)),V=0;V<e.columnHeaders.columns.length;V++)d=a[V],(u=e.columns[V]).isRequired=!1,G&&((h=f?f.cells[V]:null)&&h.value?(p=t.Workbook._parseExcelFormat(h),c=r.Globalize.format(h.value,p)):c=""),u.header=c,d&&(d.dataType===r.DataType.Boolean&&(u.dataType=d.dataType),u.format=d.format,u.align=d.hAlign,u.wordWrap=u.wordWrap||!!d.wordWrap);P&&(e.wj_sheetInfo.name=m.name,e.wj_sheetInfo.visible=!0===M||!1!==m.visible,e.wj_sheetInfo.styledCells=B,e.wj_sheetInfo.mergedRanges=H,e.wj_sheetInfo.fonts=N,e.wj_sheetInfo.tables=m.tables)}},e._parseFlexGridRowToSheetRow=function(e,o,n,a,d,u,f,h,p,g,m,w){var y,b,_,x,C,k,v,S,T,W,R,A,F,B,H,N,D,E,I,z,j,G,O,L,M,P,V,U,X,q,J=!1,$=!1;for((I=(y=e.grid).wj_sheetInfo)&&(z=I.evaluateFormula),null==(b=e.rows[n]).recordIndex?(L=0,e.cellType===l.CellType.ColumnHeader&&e.rows.length>1&&(L=n===d.length?n-1:n)):L=b.recordIndex,o.cells||(o.cells=[]),o.visible=b.isVisible,o.height=b.renderHeight||e.rows.defaultSize,o.groupLevel=g,p&&(o.collapsed=b.isCollapsed),b.wordWrap&&(o.style={wordWrap:b.wordWrap}),(b.constructor===l.Row||b.constructor===l._NewRowTemplate||s()&&b.constructor===s().DetailRow||i()&&b.constructor===i()._MultiRow)&&(J=!0),s()&&b.constructor===s().DetailRow&&($=!0),x=0;x<e.columns.length;x++)if(C=null,E=1,D=1,X=0,O=!1,H=null,V=null,P=null,S=null,G=y._getBindingColumn(e,n,e.columns[x]),N=null,I&&e===y.cells?(B=n*e.columns.length+x,I.mergedRanges&&(N=this._getMergedRange(n,x,I.mergedRanges)),I.styledCells&&(H=I.styledCells[B])):u&&(P=this._getMeasureCell(e,x,f,h),H=(N=y.getMergedRange(e,n,x,!1))?this._getCellStyle(e,P,N.bottomRow,N.rightCol)||{}:this._getCellStyle(e,P,n,x)||{}),N||(N=y.getMergedRange(e,n,x,!1)),N?n===N.topRow&&x===N.leftCol&&(D=N.bottomRow-N.topRow+1,E=this._getColSpan(e,N,m),O=!0):O=!0,!m||m(G)){if(_=d[L]?d[L][x+a]:null,J||p?(v=O?e.getCellData(n,x,!0):null,T=O?e.getCellData(n,x,!1):null,R=!1,F=null,v&&r.isString(v)&&v.length>1&&"="===v[0]&&(R=!0),j=r.isDate(T),H&&H.format?(C=H.format,/[hsmyt\:]/i.test(C)&&(j=!0),k=t.Workbook._parseCellFormat(H.format,j)):_&&_.style&&_.style.format?(C=G.format,k=_.style.format):k=null,R&&null!=z&&r.isFunction(z)&&(F=z(v)),k||(j?k="m/d/yyyy":r.isNumber(T)&&!G.dataMap?k=r.isInt(T)?"#,##0":"#,##0.00":R?(A=v.toLowerCase()).indexOf("now()")>-1?(k="m/d/yyyy h:mm",j=!0):A.indexOf("today()")>-1||A.indexOf("date(")>-1?(k="m/d/yyyy",j=!0):A.indexOf("time(")>-1&&(k="h:mm AM/PM",j=!0):k="General")):(v=O?y.columnHeaders.getCellData(0,x,!0):null,k="General"),r.isString(v)&&-1!==v.indexOf("<span")&&(S=this._parseToTextRuns(v),v=null),V=this._parseCellStyle(H)||{},e===y.cells&&p&&b.hasChildren&&x===y.columns.firstVisibleIndex){if(R&&null!=F?W=F:v?W=v:O&&(W=b.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'")),null==W&&!H)continue;!(j=r.isDate(W))&&C&&"d"===C.toLowerCase()&&r.isInt(W)&&(k="0"),W=r.isString(W)?t.Workbook._unescapeXML(W):W,x===y.columns.firstVisibleIndex&&y.treeIndent&&(X=g),M={value:W,isDate:j,formula:R?this._parseToExcelFormula(v,j):null,colSpan:E,rowSpan:D,style:this._extend(V,{format:k,font:{bold:!0},hAlign:t.HAlign.Left,indent:X}),textRuns:S}}else v=r.isString(v)?t.Workbook._unescapeXML(v):v,T=r.isString(T)?t.Workbook._unescapeXML(T):T,!j&&C&&"d"===C.toLowerCase()&&r.isInt(T)&&(k="0"),U=V&&V.hAlign?V.hAlign:_&&_.style&&null!=_.style.hAlign?r.asEnum(_.style.hAlign,t.HAlign,!0):r.isDate(T)?t.HAlign.Left:t.HAlign.General,x!==y.columns.firstVisibleIndex||!y.treeIndent||U!==t.HAlign.Left&&U!==t.HAlign.General||(X=g),M={value:R?F:"General"===k?v:T,isDate:j,formula:R?this._parseToExcelFormula(v,j):null,colSpan:x<y.columns.firstVisibleIndex?1:E,rowSpan:D,style:this._extend(V,{format:k,hAlign:U,vAlign:D>1?e===y.cells||!1===y.centerHeadersVertically?t.VAlign.Top:t.VAlign.Center:null,indent:X}),textRuns:S},$&&(q=e.getCellElement(n,x))&&q.appendChild(b.detail);w&&w(new c(e,new l.CellRange(n,x),P,f,h,M)),o.cells.push(M)}return a+x},e._parseCellStyle=function(e,o){if(void 0===o&&(o=!1),null==e)return null;var l=e.fontSize;l=l?+l.substring(0,l.indexOf("px")):null,isNaN(l)&&(l=null);var r=e.fontWeight;r="bold"===r||+r>=700;var n="italic"===e.fontStyle,s=e.textDecorationStyle;null==s&&(s=e.textDecoration),s="underline"===s;var i=e.whiteSpace;return i=!!i&&i.indexOf("pre")>-1,{font:{bold:r,italic:n,underline:s,family:this._parseToExcelFontFamily(e.fontFamily),size:l,color:e.color},fill:{color:e.backgroundColor},borders:this._parseBorder(e,o),hAlign:t.Workbook._parseStringToHAlign(e.textAlign),wordWrap:i}},e._parseBorder=function(e,o){var l={};return l.left=this._parseEgdeBorder(e,"Left"),l.right=this._parseEgdeBorder(e,"Right"),l.top=this._parseEgdeBorder(e,"Top"),l.bottom=this._parseEgdeBorder(e,"Bottom"),o&&(l.vertical=this._parseEgdeBorder(e,"Vertical"),l.horizontal=this._parseEgdeBorder(e,"Horizontal")),l},e._parseEgdeBorder=function(e,o){var l,r=e["border"+o+"Style"],n=e["border"+o+"Width"];if(n&&n.length>2&&(n=+n.substring(0,n.length-2)),r&&"none"!==r&&"hidden"!==r){switch(l={},r=r.toLowerCase()){case"dotted":l.style=n>1?t.BorderStyle.MediumDashDotted:t.BorderStyle.Dotted;break;case"dashed":l.style=n>1?t.BorderStyle.MediumDashed:t.BorderStyle.Dashed;break;case"double":l.style=t.BorderStyle.Double;break;default:l.style=n>2?t.BorderStyle.Thick:n>1?t.BorderStyle.Medium:t.BorderStyle.Thin}l.color=e["border"+o+"Color"]}return l},e._parseBorderStyle=function(e,o,l){var r="border"+o+"Style",n="border"+o+"Width";switch(e){case t.BorderStyle.Dotted:case t.BorderStyle.Hair:l[r]="dotted",l[n]="1px";break;case t.BorderStyle.Dashed:case t.BorderStyle.ThinDashDotDotted:case t.BorderStyle.ThinDashDotted:l[r]="dashed",l[n]="1px";break;case t.BorderStyle.MediumDashed:case t.BorderStyle.MediumDashDotDotted:case t.BorderStyle.MediumDashDotted:case t.BorderStyle.SlantedMediumDashDotted:l[r]="dashed",l[n]="2px";break;case t.BorderStyle.Double:l[r]="double",l[n]="3px";break;case t.BorderStyle.Medium:l[r]="solid",l[n]="2px";break;default:l[r]="solid",l[n]="1px"}},e._parseToExcelFontFamily=function(e){var o;return e&&(o=e.split(","))&&o.length>0&&(e=o[0].replace(/\"|\'/g,"")),e},e._parseToExcelFormula=function(e,o){var l,r,n,s,i,a,d,u=/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi,c=/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi,f=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(l=e.match(u))for(i=0;i<l.length;i++)d=(a=l[i]).substring(0,a.lastIndexOf(")"))+", 1)",e=e.replace(a,d);if(l=null,l=e.match(c))for(i=0;i<l.length;i++)(r=(a=l[i]).match(f))&&2===r.length&&(n=r[1],/^d{1,4}?$/.test(n)||(s=t.Workbook._parseCellFormat(n,o),d=a.replace(n,s),e=e.replace(a,d)));return e},e._parseToTextRuns=function(e){var o,l,t,r=e.split("<span "),n=[];for(o=0;o<r.length;o++)t=-1!==(l=r[o]).indexOf("</span>")?{text:l.substring(l.indexOf(">")+1,l.indexOf("</span>")),font:this._parseToTextRunFont(l.substring(l.indexOf('style="')+7,l.indexOf(';"')))}:{text:l},n.push(t);return n},e._parseToTextRunFont=function(e){var o,l,t,r,n,s,i,a,d,u=e.split(";");if(u.length>0){for(o=0;o<u.length;o++)if(2===(l=u[o].split(":")).length)switch(l[1]=l[1].trim(),l[0]){case"font-size":s=+l[1].substring(0,l[1].indexOf("px")),isNaN(s)&&(s=null);break;case"font-weight":t="bold"===l[1]||+l[1]>=700;break;case"font-style":r="italic"===l[1];break;case"text-decoration-style":case"text-decoration":n="underline"===l[1];break;case"font-family":i=this._parseToExcelFontFamily(l[1]);break;case"color":a=l[1]}d={bold:t,italic:r,underline:n,family:i,size:s,color:a}}return d},e._getMeasureCell=function(e,o,l,t){var r=t[e.cellType],n=r&&r[o],s=null==n;if(n){if(this.hasCssText){n.style;n.style.cssText="",n.style.visibility="hidden"}}else r||(t[e.cellType]=r=[]),r[o]=n=l.cloneNode();return!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n)),n},e._getColumnSetting=function(e,o,l){var n;return n=null!=e.colspan?this._getColumnRenderWidth(o,l):e.renderWidth,n=n||l.defaultSize,{autoWidth:!0,width:n,visible:e.visible,style:{format:e.format?t.Workbook._parseCellFormat(e.format,e.dataType===r.DataType.Date):"",hAlign:t.Workbook._parseStringToHAlign(this._toExcelHAlign(e.getAlignment())),wordWrap:e.wordWrap}}},e._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},e._getColumnCount=function(e){for(var o,l=0,t=0,n=0;n<e.length;n++)(o=e[n]&&e[n].cells?e[n].cells:[])&&o.length>0&&(t=o.length,r.isInt(o[t-1].colSpan)&&o[t-1].colSpan>1&&(t=t+o[t-1].colSpan-1),t>l&&(l=t));return l},e._getRowCount=function(e,o){for(var l,t,n,s=e.length,i=s-1,a=0;a<o;a++)e:for(;i>=0;i--)if(l=e[i],t=l&&l.cells?l.cells:[],(n=t[a])&&(null!=n.value&&""!==n.value||r.isInt(n.rowSpan)&&n.rowSpan>1)){r.isInt(n.rowSpan)&&n.rowSpan>1&&i+n.rowSpan>s&&(s=i+n.rowSpan);break e}return s},e._numAlpha=function(e){var o=Math.floor(e/26)-1;return(o>-1?this._numAlpha(o):"")+String.fromCharCode(65+e%26)},e._getItemType=function(e){return null==e||null==e.value||isNaN(e.value)?null:r.getType(e.value)},e._setColumn=function(e,o,l){var n,s,i,a=e[o];a?(n=this._getItemType(l),a.dataType!==n&&a.dataType===r.DataType.Boolean&&n!==r.DataType.Boolean&&(a.dataType=n),!l||null==l.value||r.isString(l.value)&&r.isNullOrWhiteSpace(l.value)||(s=t.Workbook._parseExcelFormat(l))&&a.format!==s&&"General"!==s&&(a.format=s),l&&l.style&&(l.style.hAlign&&(i=t.Workbook._parseHAlignToString(r.asEnum(l.style.hAlign,t.HAlign))),null==a.wordWrap?a.wordWrap=!!l.style.wordWrap:a.wordWrap=a.wordWrap&&!!l.style.wordWrap),i||n!==r.DataType.Number||(i="right"),a.hAlign=i):e[o]={dataType:this._getItemType(l),format:t.Workbook._parseExcelFormat(l),hAlign:"",wordWrap:null}},e._getItemValue=function(e){if(null==e||null==e.value)return null;var o=e.value;return r.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o},e._getCellStyle=function(e,o,l,t){try{e.grid.cellFactory.updateCell(e,l,t,o),o.className=o.className.replace("wj-state-selected",""),o.className=o.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(o)},e._parseTextRunsToHTML=function(e){var o,l,t,r;for(t="",r=0;r<e.length;r++)t+=(l=(o=e[r]).font)?'<span style="'+(l.bold?"font-weight: bold;":"")+(l.italic?"font-style: italic;":"")+(l.underline?"text-decoration: underline;":"")+(l.family?"font-family: "+l.family+";":"")+(null!=l.size?"font-size: "+l.size+"px;":"")+(l.color?"color: "+l.color+";":"")+'">'+o.text+"</span>":o.text;return t},e._extend=function(e,o){for(var l in o){var t=o[l];r.isObject(t)&&e[l]?r.copy(e[l],t):e[l]=t}return e},e._checkParentCollapsed=function(e,o){var l=!1;return Object.keys(e).forEach(function(t){!0===e[t]&&!1===l&&!isNaN(o)&&+t<o&&(l=!0)}),l},e._getColSpan=function(e,o,l){for(var t=0,r=o.leftCol;r<=o.rightCol;r++)l&&!l(e.columns[r])||t++;return t},e._getColumnRenderWidth=function(e,o){var l;return e>=o.length?0:null!=(l=o[e]).renderWidth?l.renderWidth:o.defaultSize},e._getMergedRange=function(e,o,l){var t,r;for(t=0;t<l.length;t++)if(r=l[t],e>=r.topRow&&e<=r.bottomRow&&o>=r.leftCol&&o<=r.rightCol)return r;return null},e}();o.FlexGridXlsxConverter=u;var c=function(e){function o(o,l,t,r,n,s){var i=e.call(this,o,l)||this;return i._cell=t,i._patternCell=r,i._xlsxCell=s,i._cellsCache=n,i}return __extends(o,e),Object.defineProperty(o.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),o.prototype.getFormattedCell=function(){return this._cell||(this._cell=u._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache),u._getCellStyle(this.panel,this._cell,this.row,this.col)),this._cell},o}(l.CellRangeEventArgs);o.XlsxFormatItemEventArgs=c});